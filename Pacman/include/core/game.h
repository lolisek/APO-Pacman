//Game loop and state management